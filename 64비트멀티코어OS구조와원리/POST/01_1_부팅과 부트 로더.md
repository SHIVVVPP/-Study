# 부팅과 부트 로더

> OS 에도 그 시작이 있다.
> 모든 OS는 동등하게 512Byte 크기의 작은 코드에서 시작한다.

512Byte의 작은 코드는 부트 로더(Boot Loader)라고 불리며, OS의 나머지 코드를 메모리에 복사해 실행시킨다.



## 부팅과 BIOS(Basic Input Output System)

부팅은 PC가 켜진 후에 OS가 실행되기 전 까지 수행되는 일련의 작업 과정을 말한다.



**부팅 과정에서 수행하는 작업에는 다음이 포함된다.**

- 프로세서 초기화(멀티코어 관련 처리 포함)
- 메모리와 외부 디바이스 검사 및 초기화
- 부트 로더를 메모리에 복사하고 OS를 시작하는 과정

<hr>

PC 환경에서는 부팅 과정 중 **하드웨어 관련된 작업을 BIOS(Basic Input/Output System)** 가 담당하며,
BIOS에서 수행하는 **각종 테스트나 초기화를 POST(Power On Self Test)** 라고 부른다.

BIOS는 메인보드에 포함된 펌웨어(Firmware)의 일종으로, 이름 그대로 입출력을 담당하는 작은 프로그램이다.

보통 PC 메인 보드에 **롬(ROM)이나 플래시 메모리로 존재** 하며,
전원이 켜짐과 동시에 **프로세서가 가장 먼저 실행하는 코드이다.**

BIOS는 부팅 옵션 설정이나 시스템 전반적인 설정 값(Configuration)을 관리하는 역할도 겸하고 있으며,
설정 값으로 시스템을 초기화하여 OS를 실행할 수 있는 환경을 만든다.

<hr>

BIOS는 부팅 과정에서 시스템 초기화 외의 수많은 작업을 하지만,
그 중에서 가장 중요한 것은 **부트 로더 이미지를 메모리로 복사하는 것이다.**

부트 로더는 부트스트랩(Bootstrap) 코드라고도 불리며 우리가 BIOS에서 처음으로 제어를 넘겨받는 부분이다.
부트 로더는 플로피 디스크나 하드 디스크 등 저장 매체의 가장 앞부분에 존재한다.

> PC는 디스크나 플래시 메모리 등 다양한 장치로 부팅할 수 있으므로 BIOS는 POST가 완료된 후 여러 장치를 검사하여 앞부분에 부트로더가 존재하는지 확인한다.
>
> **부트로더가 존재한다면 코드를 0x7C00 어드레스에 복사한 후,**
>  **프로세서가 0x7C00 어드레스부터 코드를 수행하도록 한다.**
>
> 부팅 가능한 모든 장치를 검사했는데도 부트로더를 찾을 수 없다면
> ***BIOS 'Operating System Not Found'*** 와 같은 메시지를 출력하고 작업을 중단한다.

부트 로더가 디스크에서 메모리로 복사되어 실행되었다는 것은
BIOS에 의해 PC가 정상적으로 구동되었다는 것을 의미한다.

> OS가 메모리에 올라와 실행할 준비가 된 것이다.

<hr>

## 부트로더의 역할과 구성

부트로더는 플로피 디스크나 하드 디스크 같은 외부 저장 매체에 있으며,
저장 매체에서 가장 첫 번째 섹터 **MBR(Master Boot Record)** 에 있는 작은 프로그램이다.

> 섹터(Sector)는 디스크를 구성하는 데이터 단위로, 섹터 하나는 512Byte로 구성된다.

**부트로더의 가장 큰 역할**

- **OS 실행에 필요한 환경 설정**
- **OS 이미지를 메모리에 복사**

부트 로더는 512Byte로 정해져 있다.

> 즉, 공간 제약이 있어서 처리할 수 있는 기능이 한정된다.
>
> 따라서 대부분 부트로더는 OS 이미지를 메모리로 복사하고 제어를 넘겨주는 정형화된 작업을 수행한다.

<hr>

### BIOS에 첫 번째 섹터가 부트 로더인 것을 어떻게 알까?

이를 위해 BIOS는 읽어들인 512Byte 중에 가장 마지막 2바이트의 값이 **0x55, 0xAA** 인지 검사해 확인한다.

> 읽은 데이터가 **0x55, 0xAA** 로 끝나지 않는다면 데이터로 인식하고 부팅 과정을 더 진행하지 않는다.

<hr>



<hr>