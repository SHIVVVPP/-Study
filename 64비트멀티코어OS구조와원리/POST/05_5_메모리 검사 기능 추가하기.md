# 메모리 크기 검사 기능 추가

사용 가능한 메모리를 검사하는 가장 확실한 방법은
메모리에 특정 값을 쓰고 다시 읽어서 같은 값이 나오는지 확인하는 것이다.

> 만일 해당 어드레스가 진짜 물리 메모리라면 쓴 값이 그대로 읽힐 것이다.
>
> 해당 어드레스가 진짜 물리 메모리가 아니라면,
> 쓴 값은 저장되지 않았으므로 임의의 값이 읽히게 된다.

<hr>

물론 메모리 크기의 검사를 BIOS 영역에서 읽어올 수도 있지만,
BIOS마다 구현에 차이가 있을 수 있으므로 직접 검사하여 측정한다.

검사하는 방법은 1MB 단위로 어드레스를 증가시키면서,
각 MB의 첫 번째 4바이트에 0x12345678를 쓰고 읽는 것으로 하겠다.

> 물론 전체 영역을 바이트 단위로 검사할 수 있지만,
> PC에 설치된 메모리 크기가 GB단위라면 많은 시간이 걸릴 것이다.
>
> 우리가 사용하는 PC의 메모리 크기가 MB 또는 GB 단위로 증가함을 고려할 때,
> 1MB 단위로 첫 번째 4바이트를 검사하는 것으로 충분하다.

<hr>

이제 최소 메모리 용량을 검사하는 함수를 커널 엔트리 포인트에 추가해보자

IA-32e 모드의 커널이 위치할 공간을 0으로 초기화 하는 함수 전에 
미리 메모리의 크기가 64MB 이상인지 검사하여, 

그 이하면 에러 메시지를 출력하고 정지시키고, 
*kInitializeKernel64Area()* 함수 역시 메모리 크기를 검사하는 함수와 마찬가지로 
초기화한 값을 검증하고 나서 성공/실패를 반환하도록 수정한다.