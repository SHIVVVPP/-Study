# BIOS 서비스와 소프트웨어 인터럽트

BIOS는 키보드 / 마우스에서 디스크나 프린터까지 거의 모든 PC주변기기를 제어하는 기능을 제공한다.

BIOS는 우리가 일반적으로 많이 쓰는 라이브러리 대신 자신의 기능을 특별한 방법으로 외부에 제공한다.

**함수의 어드레스를 인터럽트 벡터 테이블( *Interrupt Vector Table* )에 넣어두고,**
**소프트웨어 인터럽트( *SWI, Software Interrupt* ) 을 사용한다.**

<hr>

 #### 인터럽트 벡터 테이블

인터럽트 벡터 테이블은 메모리 어드레스 0에 있는 테이블로,
**특정 번호의 인터럽트가 발생했을 때 인터럽트를 처리하는 함수(Interrupt Handler) 를 검색하는데 사용한다.** 

> 테이블의 각 항목은 인덱스에 해당하는 인터럽트가 발생했을 때 처리하는 함수의 어드레스가 저장되어 있다.
>
> 또한 인터럽트는 최대 256개까지 설정할 수 있으므로 
> 리얼 모드의 인터럽트 벡터 크기는 최대 256 * 4 = 1024바이트가 된다.

< 리얼 모드의 주요 인터럽트 벡터 테이블 >

![image](https://user-images.githubusercontent.com/34773827/60758782-36e32c00-a056-11e9-913e-b796ad4b668c.png)

BIOS가 제공하는 디스크 서비스를 사용하려면 표에서 처럼 **0x13 인터럽트** 를 발생시켜야 한다.

우리는 임의로 인터럽트를 발생시킬 수 있는데,
SWI(SoftWareInterrupt)는 CPU에 가상으로 특정 인터럽트가 발생했다고 알리는
 **``int 0x13``** 형태로 사용한다.

> 우리가 직접 만든 함수의 어드레스를 인터럽트 벡터 테이블에 넣어두어도
> **int** 명령어로 언제든지 해당 함수로 이동할 수 있다.



<hr>

### SWI (Software Interrupt) 에 파라미터를 넘기는 법

BIOS 서비스는  SWI를 통해 호출할 수 있지만, 작업에 관련된 파라미터를 넘겨 주어야 한다.

BIOS의 기능을 사용할 때는 
**AX, BX, CX, DX 레지스터와 ES 세그먼트 레지스터를 사용해서 파라미터를 넘겨주며,**
**결과값 또한 레지스터를 통해 넘겨 받는다.**

> BIOS 서비스마다 요구하는 파라미터의 수가 다르므로 
> 서비스를 호출할 때 파라미터로 정의된 레지스터를 확인해야 한다.

![image](https://user-images.githubusercontent.com/34773827/60758866-3c8d4180-a057-11e9-9f30-cadf67830d73.png)

> 표에서 AX 레지스터는 기능 선택과 처리한 결과값을 받을 때 공통으로 사용되는 것을 알 수 있는데,
> 이는 BIOS의 디스크관련 서비스 뿐 아니라 다른 서비스에도 마찬가지로 적용되는 규칙이다.



