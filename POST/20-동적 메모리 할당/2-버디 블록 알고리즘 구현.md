# 버디 블록 알고리즘 구현

## 동적 메모리 할당을 위한 메모리 영역 지정

메모리를 동적으로 할당하고 해제하려면 전체 메모리 영역에서 어느 만큼을 동적 메모리로 사용할지 정해야 한다.

멀티태스킹 기능이 추가된 지금까지 OS가 사용한 메모리는 다음과 같다.

![image](https://user-images.githubusercontent.com/34773827/61959625-c600b580-affe-11e9-8453-f9dcbd7842f1.png)

약 17MB 영역까지 메모리를 사용한다.<br>따라서 동적 할당을 위한 영역은 최소한 스택 풀이 끝나는 위치에서 시작해야 한다.

동적 메모리 영역의 시작 어드레스를 17MB로 결정 되었으니, 마지막 어드레스를 정해야한다.<br>마지막 어드레스는 실제 존재하는 물리 메모리의 범위 안에만 범위 안에만 존재한다면 어느 곳을 지정해도 되지만, 

시작 어드레스와 마지막 어드레스에 따라 최대로 할당할 수 있는 블록의 크기와 블록의 수가 달라지므로 이 점을 고려해 결정해야 한다.

우리 OS는 단순한 메모리 할당과 해제부터 응용프로그램 실행, 그래픽 유저 인터페이스까지 메모리가 필요한 모든 작업을 동적 메모리로 처리한다.

따라서, 동적 메모리 영역이 크면 클수록 더 많은 작업을 할 수 있으므로,<br>3GB 범위 내의 물리 메모리의 끝까지를 동적 메모리 영역으로 설정한다.

<hr>

## 버디 블록 알고리즘 세부 설계

버디 블록 알고리즘은 메모리를 할당하고 해제할 때마다 블록을 분할하고 결합하는 작업을 한다.<br>최악의 경우 분할하고 결합하는 작업을 매번 반복해야 하므로,<br>이러한 작업을 빠르게 수행할 수 있도록 **블록 리스트를 유지하는 것이 핵심이다.**

검색이 빈번한 경우는 리스트가 적합하지 않으므로, 일반적으로 많이 사용하는 비트맵을 통해 구현한다.

### 비트맵

비트맵(Bitmap)이란 **데이터당 1비트를 할당하여 0이나 1로 정보를 표시하는 방법** 이다.

> 1바이트는 8비트이므로 비트맵을 사용하면 작은 공간으로 많은 데이터를 저장할 수 있다.<br>또한 데이터의 인덱스를 바이트 오프셋(Byte Offset)과 바이트 내에 비트 오프셋(Bit Offset)으로 변환하여 특정 데이터에 직접 접근할 수 있으므로, 리스트와 달리 인접한 블록에 바로 접근할 수 있는 장점이 있다.



